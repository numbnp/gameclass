<?xml version="1.0" encoding="Windows-1251" standalone="no"?>
<REPORTS version="2.0"><REPORT name="Прибыль по дням недели" description="Прибыль клуба по дням недели. Позволяет детальнее проработать тарифы и просто любопытная информация :) 
---  
Author: GameClass Software  
support@gameclass.ru 
" code="set nocount on 
CREATE TABLE #tpw (   
[id] [int] NOT NULL ,   
[name] [varchar] (25) COLLATE Cyrillic_General_CI_AS NULL 
) ON [PRIMARY]   
INSERT INTO #tpw (id, name) VALUES (1, N'Понедельник') 
INSERT INTO #tpw (id, name) VALUES (2, N'Вторник') 
INSERT INTO #tpw (id, name) VALUES (3, N'Среда') 
INSERT INTO #tpw (id, name) VALUES (4, N'Четверг') 
INSERT INTO #tpw (id, name) VALUES (5, N'Пятница') 
INSERT INTO #tpw (id, name) VALUES (6, N'Суббота') 
INSERT INTO #tpw (id, name) VALUES (7, N'Воскресенье') 
select  
#tpw.name as [День недели],  
SUM([summa]) as [Сумма] 
from [repDetails] 
inner join #tpw on (#tpw.id = DATEPART(dw, [moment]) ) 
where ([moment]  &gt;= %TIME-START%) and ([moment]&lt;=%TIME-STOP%) 
GROUP BY #tpw.name, DATEPART(dw, [moment]) 
ORDER BY DATEPART(dw, [moment]) asc 
if object_id('tempdb..#tpw') is not null   
DROP TABLE #tpw   " author="NodaSoft" guid="{8FBC8ABC-7434-4b63-BEC8-96BD54319D42}" isfolder="False" version="1"><REPORTCOLUMNS/></REPORT></REPORTS>
